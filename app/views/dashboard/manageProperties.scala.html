@import _root_.template.Display

@(model: controllers.ManagePropertiesVM)(implicit request: Request[_], messages: Messages)

@showEditColumn = @{ model.properties.pending.exists(_.representations.nonEmpty) || model.properties.added.exists(_.representations.nonEmpty) }

@main_template(title = Messages("dashboard.home.title")) {
        <div class="grid-row">
            <div class="column-two-thirds">
                <h1 class="form-title heading-xlarge">
                    <span class="section-title">@Messages("dashboard.manageProperties.title")</span>
                </h1>
            </div>
        </div>
        <table class="table">
            <tbody>
                <tr>
                    <th>@Messages("manageProperties.table.1")</th>
                    <th>@Messages("manageProperties.table.2")</th>
                    <th>@Messages("manageProperties.table.3")</th>
                    <th>@Messages("manageProperties.table.4")</th>
                    <th></th>
                    @if(showEditColumn) {
                        <th></th>
                    }
                </tr>
                @model.properties.added.map { p =>
                    <tr>
                        <td>@p.name</td>
                        <td>@Messages(p.capacity.msgKey)</td>
                        <td>@Messages("dashboard.manageProperties.status.added")</td>
                        <td>@Display.date(p.linkedDate)</td>
                        <td>
                            <a href=@routes.AppointAgentController.add(p.linkId)>@Messages("dashboard.addAgent")</a>
                        </td>
                        @if(showEditColumn) {
                            <td>
                                @if(p.representations.nonEmpty) {
                                    <a href=@routes.AppointAgentController.edit(p.linkId)>
                                    @Messages("dashboard.editAgent")
                                    </a>
                                }
                            </td>
                        }
                    </tr>
                }
                @model.properties.pending.map { p =>
                    <tr>
                        <td>@p.name</td>
                        <td>@Messages(p.capacity.msgKey)</td>
                        <td>@Messages("dashboard.manageProperties.status.pending")</td>
                        <td>@Display.date(p.linkedDate)</td>
                        <td>
                            <a href=@routes.AppointAgentController.add(p.linkId)>@Messages("dashboard.addAgent")</a>
                        </td>
                        @if(showEditColumn) {
                            <td>
                                @if(p.representations.nonEmpty) {
                                    <a href=@routes.AppointAgentController.edit(p.linkId)>@Messages("dashboard.editAgent")</a>
                                }
                            </td>
                        }
                    </tr>
                }
            </tbody>
        </table>

        <p><a href="@routes.Search.show" id="addAnotherProperty">@Messages("dashboard.managedProperties.searchLinkText")</a></p>
        <p><a href="@routes.Dashboard.home" id="home">@Messages("link.dashboard.home")</a></p>

}
